clear all
close all
clc

k_11_bendra = 1.0989e9;
k_12_bendra = 0.32967e9;
k_22_bendra = 1.098e9;
k_23_bendra = 0;
k_13_bendra = 0;
k_33_bendra = 0.384615e9;

S=0.00125;
t=6e-3;

%%===============Elementas A==============================
a_1 = -0.05;
a_2 = 0;
a_3 = 0.05;
b_1 = 0.05;
b_2 = -0.05;
b_3 = 0;

k_11=t/(4*S)*k_11_bendra
k_12=t/(4*S)*k_12_bendra
k_13=t/(4*S)*k_13_bendra
k_22=t/(4*S)*k_22_bendra
k_23=t/(4*S)*k_23_bendra
k_33=t/(4*S)*k_33_bendra
%%
k_a1 = (k_11*b_1*b_1+k_33*a_1*a_1+k_13* (b_1*a_1+b_1*a_1 )) / 10^6
k_a2 = (k_11*b_1*b_2+k_33*a_1*a_2+k_13* (b_1*a_2+b_2*a_1 )) / 10^6
k_a3 = (k_11*b_1*b_3+k_33*a_1*a_3+k_13* (b_1*a_3+b_3*a_1 )) / 10^6
k_a4 = (k_11*b_2*b_2+k_33*a_2*a_2+k_13* (b_2*a_2+b_2*a_2 )) / 10^6
k_a5 = (k_11*b_2*b_3+k_33*a_2*a_3+k_13* (b_2*a_3+b_3*a_2 )) / 10^6
k_a6 = (k_11*b_3*b_3+k_33*a_3*a_3+k_13* (b_3*a_3+b_3*a_3 )) / 10^6
%%
k_b1=(k_33*b_1 *b_1+k_22*a_1 *a_1+k_23* (b_1*a_1+b_1*a_1 )) / 10^6
k_b2=(k_33*b_1 *b_2+k_22*a_1 *a_2+k_23* (b_1*a_2+b_2*a_1 )) / 10^6
k_b3=(k_33*b_1 *b_3+k_22*a_1 *a_3+k_23* (b_1*a_3+b_3*a_1 )) / 10^6
k_b4=(k_33*b_2 *b_2+k_22*a_2 *a_2+k_23* (b_2*a_2+b_2*a_2 )) / 10^6
k_b5=(k_33*b_2 *b_3+k_22*a_2 *a_3+k_23* (b_2*a_3+b_3*a_2 )) / 10^6
k_b6=(k_33*b_3 *b_3+k_22*a_3 *a_3+k_23* (b_3*a_3+b_3*a_3 )) / 10^6
%%
k_c1=(k_13*b_1* b_1+k_23*a_1* a_1+k_12*b_1* a_1+k_33*b_1* a_1) / 10^6
k_c2=(k_13*b_1* b_2+k_23*a_1* a_2+k_12*b_1* a_2+k_33*b_2* a_1) / 10^6
k_c3=(k_13*b_1* b_3+k_23*a_1* a_3+k_12*b_1* a_3+k_33*b_3* a_1) / 10^6
k_c4=(k_13*b_2* b_1+k_23*a_2* a_1+k_12*b_2* a_1+k_33*b_1* a_2) / 10^6
k_c5=(k_13*b_2* b_2+k_23*a_2* a_2+k_12*b_2* a_2+k_33*b_2* a_2) / 10^6
k_c6=(k_13*b_2* b_3+k_23*a_2* a_3+k_12*b_2* a_3+k_33*b_3* a_2) / 10^6
k_c7=(k_13*b_3* b_1+k_23*a_3* a_1+k_12*b_3* a_1+k_33*b_1* a_3) / 10^6
k_c8=(k_13*b_3* b_2+k_23*a_3* a_2+k_12*b_3* a_2+k_33*b_2* a_3) / 10^6
k_c9=(k_13*b_3* b_3+k_23*a_3* a_3+k_12*b_3* a_3+k_33*b_3* a_3) / 10^6
%%

k_a = [k_a1  k_a2  k_a3; k_a2  k_a4  k_a5; k_a3  k_a5  k_a6];

k_b = [k_b1  k_b2  k_b3; k_b2  k_b4  k_b5; k_b3  k_b5  k_b6];

k_c = [k_c1  k_c2  k_c3; k_c4  k_c5  k_c6; k_c7  k_c8  k_c9];

k_c_t = transpose(k_c);

% Pilna elemento matrica (6x6)
Ka_a = [k_a   k_c; k_c_t k_b]

% Standumo matrica sistemoje (8x8)
Ka_first  = zeros(8,8);

map = [1 2 4 5 6 8];

Ka_first(map, map) = Ka_a
%%
%%===============Elementas B==============================
a_1 = -0.09;
a_2 = 0.05;
a_3 = 0.04;
b_1 = 0.03;
b_2 = -0.05;
b_3 = 0.02;

S=0.0015;

k_11=t/(4*S)*k_11_bendra
k_12=t/(4*S)*k_12_bendra
k_13=t/(4*S)*k_13_bendra
k_22=t/(4*S)*k_22_bendra
k_23=t/(4*S)*k_23_bendra
k_33=t/(4*S)*k_33_bendra
%%
k_a1 = (k_11*b_1*b_1+k_33*a_1*a_1+k_13* (b_1*a_1+b_1*a_1 )) / 10^6
k_a2 = (k_11*b_1*b_2+k_33*a_1*a_2+k_13* (b_1*a_2+b_2*a_1 )) / 10^6
k_a3 = (k_11*b_1*b_3+k_33*a_1*a_3+k_13* (b_1*a_3+b_3*a_1 )) / 10^6
k_a4 = (k_11*b_2*b_2+k_33*a_2*a_2+k_13* (b_2*a_2+b_2*a_2 )) / 10^6
k_a5 = (k_11*b_2*b_3+k_33*a_2*a_3+k_13* (b_2*a_3+b_3*a_2 )) / 10^6
k_a6 = (k_11*b_3*b_3+k_33*a_3*a_3+k_13* (b_3*a_3+b_3*a_3 )) / 10^6
%%
k_b1=(k_33*b_1 *b_1+k_22*a_1 *a_1+k_23* (b_1*a_1+b_1*a_1 )) / 10^6
k_b2=(k_33*b_1 *b_2+k_22*a_1 *a_2+k_23* (b_1*a_2+b_2*a_1 )) / 10^6
k_b3=(k_33*b_1 *b_3+k_22*a_1 *a_3+k_23* (b_1*a_3+b_3*a_1 )) / 10^6
k_b4=(k_33*b_2 *b_2+k_22*a_2 *a_2+k_23* (b_2*a_2+b_2*a_2 )) / 10^6
k_b5=(k_33*b_2 *b_3+k_22*a_2 *a_3+k_23* (b_2*a_3+b_3*a_2 )) / 10^6
k_b6=(k_33*b_3 *b_3+k_22*a_3 *a_3+k_23* (b_3*a_3+b_3*a_3 )) / 10^6
%%
k_c1=(k_13*b_1* b_1+k_23*a_1* a_1+k_12*b_1* a_1+k_33*b_1* a_1) / 10^6
k_c2=(k_13*b_1* b_2+k_23*a_1* a_2+k_12*b_1* a_2+k_33*b_2* a_1) / 10^6
k_c3=(k_13*b_1* b_3+k_23*a_1* a_3+k_12*b_1* a_3+k_33*b_3* a_1) / 10^6
k_c4=(k_13*b_2* b_1+k_23*a_2* a_1+k_12*b_2* a_1+k_33*b_1* a_2) / 10^6
k_c5=(k_13*b_2* b_2+k_23*a_2* a_2+k_12*b_2* a_2+k_33*b_2* a_2) / 10^6
k_c6=(k_13*b_2* b_3+k_23*a_2* a_3+k_12*b_2* a_3+k_33*b_3* a_2) / 10^6
k_c7=(k_13*b_3* b_1+k_23*a_3* a_1+k_12*b_3* a_1+k_33*b_1* a_3) / 10^6
k_c8=(k_13*b_3* b_2+k_23*a_3* a_2+k_12*b_3* a_2+k_33*b_2* a_3) / 10^6
k_c9=(k_13*b_3* b_3+k_23*a_3* a_3+k_12*b_3* a_3+k_33*b_3* a_3) / 10^6
%%

k_a = [k_a1  k_a2  k_a3; k_a2  k_a4  k_a5; k_a3  k_a5  k_a6];

k_b = [k_b1  k_b2  k_b3; k_b2  k_b4  k_b5; k_b3  k_b5  k_b6];

k_c = [k_c1  k_c2  k_c3; k_c4  k_c5  k_c6; k_c7  k_c8  k_c9];

k_c_t = transpose(k_c);

% Pilna elemento matrica (6x6)
Ka_b = [k_a   k_c; k_c_t k_b]

% Standumo matrica sistemoje (8x8)
Ka_second  = zeros(8,8);

map = [2 3 4 6 7 8];

Ka_second(map, map) = Ka_b
%%
%%===================Bendra Matrica===================
Ka = (Ka_first + Ka_second) * 10^6
%%
%%==================pirmas atvejis====================
F = [0; 0; -500; -500]

idx = [2 3 6 7];
K_k = Ka(idx, idx) 
K_inverse = inv(K_k)
u1 = K_k \ F
%%

%%==================antras atvejis====================
F = [0; 0; 0; 1000]

idx = [2 3 6 7];
K_k = Ka(idx, idx) 
K_inverse = inv(K_k)
u2 = K_k \ F